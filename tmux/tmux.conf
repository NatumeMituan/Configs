# ------------------------------------------------------------------------- #
# Options
# - https://github.com/tmux/tmux/wiki/Getting-Started#types-of-option
# - https://www.man7.org/linux/man-pages/man1/tmux.1.html, "OPTIONS" section

# - `set` is the alias of `set-option`, `show` is the alias of `show-options`
# - `@` prefix: user option
# - `-w`: window, `-s`: server, otherwise session
# - `-g`: global session or window option, does nothing for server options
# - `-a`: append, `-u`: unset

# - If the option is not a user option, `-w` or `-s` may be unnecessary
#   tmux will infer the type from the option name.
#   So it should alway be safe to use `-g` for any options:
#   - If it's a server option, `-g` does nothing
#   - If it's a session or window option, `-g` sets it for all sessions
# ------------------------------------------------------------------------- #

# RGB color (24 bit true color) and italics

# Change the default $TERM to tmux-256color for italics and 256 color support

# GNU screen (screen or screen-* like screen-256color) does not support italics:
# https://github.com/tmux/tmux/wiki/FAQ#i-dont-see-italics-or-italics-and-reverse-are-the-wrong-way-round

# 256 color: https://github.com/tmux/tmux/wiki/FAQ#how-do-i-use-a-256-colour-terminal

# Additional steps are required for macos to enable tmux-256color:
# - https://github.com/Homebrew/homebrew-core/issues/102748#issuecomment-1145378599
# - https://github.com/Homebrew/homebrew-core/issues/102748#issuecomment-1150401279

# `default-termina` is now a session option, not a server option anymore:
# https://github.com/tmux/tmux/commit/310f0a960ca64fa3809545badc629c0c166c6cd2#diff-aac07aefec754086f5c344e2c233862f6a611c739b5647fd456c1b77d3577c79R14

set -g default-terminal "tmux-256color"

# Tell tmux that the terminal outside supports RGB color to enable RGB
# https://github.com/tmux/tmux/wiki/FAQ#how-do-i-use-rgb-colour
# https://gist.github.com/andersevenrud/015e61af2fd264371032763d4ed965b6dd
set -ag terminal-overrides ",$TERM:RGB"

# enable mouse mode (tmux 2.1 and above)
set -g mouse on

# Address vim mode switching delay: http://superuser.com/a/252717/65504
# 10 to avoid garbage printed in wsl: https://github.com/microsoft/WSL/issues/1638
set -g escape-time 10

# Increase scrollback buffer size from 2000 to 100,000 lines
set -g history-limit 100000

# Increase tmux messages display duration from 750ms to 5s
set -g display-time 5000

# Refresh 'status-left' and 'status-right' more often, from every 15s to 5s
set -g status-interval 5

set -g mode-keys vi
set -g status-keys emacs

# Plugins
# https://github.com/tmux-plugins/tpm
set -g @plugin 'tmux-plugins/tpm'
# https://github.com/catppuccin/tmux
set -g @plugin 'catppuccin/tmux'

# Design changes
set -g @catppuccin_flavour 'macchiato' # or frappe, latte, mocha
set -g @catppuccin_window_default_text "#W"
set -g @catppuccin_window_current_text "#W"
set -g @catppuccin_status_modules "directory session date_time"
set -g @catppuccin_status_left_separator "█"
set -g @catppuccin_status_right_separator "█"

# ------------------------------------------------------------------------- #
# Key bindings
# ------------------------------------------------------------------------- #

# remap prefix from 'C-b' to 'C-a'
unbind C-b
set -g prefix C-a
bind-key C-a send-prefix
bind C-p previous-window
bind C-n next-window
bind a last-window

# split panes using \ and -
bind \\ split-window -h
bind - split-window -v
unbind '"'
unbind %

# reload config file (change file location to your the tmux.conf you want to use)
bind r source-file ~/.config/tmux/tmux.conf

# switch panes using vi keys
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# swap windows using < and >
bind < swap-window -t -
bind > swap-window -t +
# Local configs
if-shell '[ -f ~/.config/tmux/tmux.conf.local ]' {
    source-file ~/.config/tmux/tmux.conf.local
}

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.config/tmux/plugins/tpm/tpm'

# Reference:
# - https://github.com/tmux/tmux/blob/master/example_tmux.conf
# - https://github.com/tmux-plugins/tmux-sensible
# - https://www.hamvocke.com/blog/a-guide-to-customizing-your-tmux-conf